<!-- Alert Component -->
<div class="alert-container" *ngIf="showAlertComponent">
  <app-alert
    [message]="alertMessage"
    [type]="alertType"
    [dismissible]="true"
    (closed)="onAlertClosed()">
  </app-alert>
</div>

<!-- Formulario de Login -->
<div *ngIf="!showSuccessMessage" class="auth-section">
  <div class="welcome-header">
    <h1>¡Bienvenido a MocaBits!</h1>
    <p class="welcome-subtitle">Inicia sesión en tu cuenta</p>
  </div>

  <form class="auth-form" [formGroup]="loginForm" (ngSubmit)="onLogin()">
    <div class="form-group">
      <app-input
        formControlName="email"
        type="email"
        label="Correo Electrónico"
        placeholder="correo@empresa.com"
        rightIcon="email"
        [required]="true"
        [errorMessage]="getFieldError('email')"
        [state]="isFieldInvalid('email') ? 'error' : (loginForm.get('email')?.valid && loginForm.get('email')?.value ? 'success' : 'default')"
        autocomplete="email"
        (inputChange)="onEmailInput()">
        <svg slot="right-icon" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
          <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.89 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
        </svg>
      </app-input>
    </div>

    <div class="form-group">
      <app-input
        formControlName="password"
        type="password"
        label="Contraseña"
        placeholder="Ingresa tu contraseña"
        rightIcon="password"
        [showPasswordToggle]="true"
        [required]="true"
        [errorMessage]="getFieldError('password')"
        [state]="isFieldInvalid('password') ? 'error' : 'default'"
        autocomplete="current-password"
        (inputChange)="onPasswordInput()">
        <svg slot="right-icon" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
          <path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"/>
        </svg>
      </app-input>
    </div>

    <div class="form-actions">
      <app-button
        type="submit"
        variant="primary"
        size="lg"
        [disabled]="loginForm.invalid"
        [loading]="isLoading"
        [fullWidth]="true"
        [icon]="loginIcon"
        iconPosition="left"
        [showIconWhenLoading]="false">
        <span *ngIf="!isLoading">Iniciar Sesión</span>
        <span *ngIf="isLoading">Validando credenciales...</span>
      </app-button>
    </div>

    <div class="form-footer">
      <app-button 
        type="button" 
        variant="ghost"
        size="sm"
        (click)="onForgotPassword()">
        ¿Olvidaste tu contraseña?
      </app-button>

      <div class="signup-prompt">
        ¿No tienes cuenta?
        <app-button 
          type="button" 
          variant="ghost"
          size="sm"
          (click)="onCreateUser()">
          Crear cuenta
        </app-button>
      </div>
    </div>
  </form>
</div>

<!-- Mensaje de éxito del login -->
<div *ngIf="showSuccessMessage" class="success-message login-success">
  <div class="success-icon">
    <svg width="32" height="32" viewBox="0 0 24 24" fill="currentColor">
      <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
    </svg>
  </div>
  <h3>¡Bienvenido a MocaBits!</h3>
  <p>Inicio de sesión exitoso. Redirigiendo al dashboard...</p>
  <div class="loading-bar">
    <div class="progress"></div>
  </div>
</div>